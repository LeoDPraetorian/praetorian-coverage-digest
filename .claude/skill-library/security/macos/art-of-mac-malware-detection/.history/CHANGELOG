## 2026-01-12 - Initial Creation

**RED Phase Documentation:**
- **Gap identified**: When building macOS security tools, implementing malware detection, or developing monitoring capabilities, Claude needs authoritative reference material on Mac-specific APIs, frameworks, and implementation patterns for security tooling
- **Test scenario**: "How do I use the Endpoint Security framework to monitor process execution and file creation in real-time, and how do I implement muting for performance?"
- **Without skill**: Claude would provide general endpoint monitoring concepts or refer to Apple documentation, but lack the practical implementation patterns, gotchas, and production-ready architectures needed for real tools
- **With skill**: Claude can reference Patrick Wardle's comprehensive guide, which includes complete working tool implementations, API usage patterns, performance optimization (muting), and real-world architectures from Objective-See tools

**Skill Details:**
- **Name**: art-of-mac-malware-detection
- **Location**: .claude/skill-library/security/macos/art-of-mac-malware-detection/
- **Category**: Library skill (security/macos)
- **Type**: Library/Framework (reference documentation)
- **Source**: The Art of Mac Malware Volume 2 by Patrick Wardle (2025, No Starch Press)
- **Book location**: Books/ArtofMacMalwareVol2_full_repair.md (12,561 lines)

**Coverage:**

Part I: Data Collection (Chapters 1-5)
- Chapter 1: Examining processes (enumeration, hierarchy, code signing, files/sockets, memory, libraries)
- Chapter 2: Parsing binaries (Mach-O format, headers, dependencies, symbols, packed detection)
- Chapter 3: Code signing (verification APIs, notarization, certificate chains, detecting unsigned code)
- Chapter 4: Network state and statistics (connections, sockets, process-to-network mapping)
- Chapter 5: Persistence (enumerating all persistence mechanisms programmatically)

Part II: System Monitoring (Chapters 6-9)
- Chapter 6: Log monitoring (Unified Logging, OSLog framework, security events)
- Chapter 7: Network monitoring (Network Extension framework, packet filtering, DNS, TLS)
- Chapter 8: Endpoint Security (ES framework architecture, event types, client development)
- Chapter 9: Muting and authorization events (performance optimization, policy enforcement)

Part III: Tool Development (Chapters 10-14)
- Chapter 10: Persistence Enumerator (one-shot detection tool)
- Chapter 11: Persistence Monitor (real-time persistence detection)
- Chapter 12: Mic and Webcam Monitor (privacy protection tool like OverSight)
- Chapter 13: DNS Monitor (network threat detection like LuLu)
- Chapter 14: Case studies (real-world detection scenarios)

**Structure:**
- SKILL.md: 360 lines (under 500-line limit) âœ“
- Provides navigation and search strategies for 12K-line book
- Documents key frameworks (Endpoint Security, Network Extension, OSLog)
- Code-heavy focus with complete tool implementations
- Integration section documents relationship with Volume 1 (analysis)

**Author expertise:**
- Patrick Wardle: Founder of Objective-See, Co-founder/CEO of DoubleYou
- Creator of free macOS security tools (all open source with working implementations)
- Leading expert in Mac security tool development
- Tools featured in book: KnockKnock, BlockBlock, OverSight, LuLu

**Practical value:**
- Book includes complete source code for 4 production tools
- Patterns used in real, deployed security software
- Endpoint Security framework is the foundation of modern Mac security tools
- Open source examples available for study and adaptation

**Created by**: book-to-skill conversion workflow
**Complements**: art-of-mac-malware-development (Volume 1) for analysis techniques
**Next steps**: GREEN phase testing, gateway assignment, REFACTOR pressure testing
