feature_name: "TanStack Ecosystem Migration & URL Security Refactor"
feature_slug: "url-refactoring"
created_at: "2025-12-31T00:00:00Z"
created_by: "frontend-reviewer"
description: |
  Migrate Chariot frontend to TanStack ecosystem (Router, Table, Virtual) while
  eliminating URL security vulnerabilities (PII exposure from impersonation).
  Drawer state remains in URL search params to preserve shareable links.

  Phase 0: Preparatory work including test infrastructure, feature flags,
  performance baseline, and blocking item resolution.

status: "in-progress"

current_phase: "phase-3-4-batches-1-3-review"
phases_complete:
  - "phase-0"
  - "phase-1"
  - "phase-2-implementation"

agents_contributed:
  - agent: "frontend-reviewer"
    artifact: "reviews/FRONTEND-REVIEWER-PHASE0-REVIEW.md"
    timestamp: "2026-01-01T00:00:00Z"
    status: "complete"
    phase: "phase-0-review"

  - agent: "frontend-tester"
    artifact: "frontend-tester-pr-0.1-implementation.md"
    timestamp: "2026-01-01T19:00:00Z"
    status: "complete"
    phase: "phase-0-pr01"

  - agent: "frontend-tester"
    artifact: "frontend-tester-pr02-implementation.md"
    timestamp: "2026-01-01T11:27:24Z"
    status: "complete"
    phase: "phase-0-pr02"

  - agent: "frontend-tester"
    artifact: "frontend-tester-phase1-task16-integration-tests.md"
    timestamp: "2026-01-01T21:38:00Z"
    status: "complete"
    phase: "phase-1-task16"

  - agent: "frontend-orchestrator"
    artifact: "phase-1-implementation-summary.md"
    timestamp: "2026-01-01T21:48:00Z"
    status: "complete"
    phase: "phase-1"

  - agent: "frontend-developer"
    artifact: "src/state/impersonation.tsx"
    timestamp: "2026-01-01T21:45:00Z"
    status: "complete"
    phase: "phase-1-task11"

  - agent: "frontend-developer"
    artifact: "src/state/auth.tsx"
    timestamp: "2026-01-01T21:47:00Z"
    status: "complete"
    phase: "phase-1-task14-15"

  - agent: "frontend-lead"
    artifact: "reviews/FRONTEND-LEAD-PHASE1-REVIEW.md"
    timestamp: "2026-01-01T21:55:00Z"
    status: "complete"
    phase: "phase-1-review"

  - agent: "frontend-reviewer"
    artifact: "reviews/FRONTEND-REVIEWER-PHASE1-REVIEW.md"
    timestamp: "2026-01-01T21:55:00Z"
    status: "complete"
    phase: "phase-1-review"

  - agent: "test-lead"
    artifact: "reviews/TEST-LEAD-PHASE1-REVIEW.md"
    timestamp: "2026-01-01T21:55:00Z"
    status: "complete"
    phase: "phase-1-review"

  - agent: "frontend-developer"
    artifact: "src/utils/entityKeyHasher.ts"
    timestamp: "2026-01-06T14:00:00Z"
    status: "complete"
    phase: "phase-2-task21"

  - agent: "frontend-developer"
    artifact: "src/utils/entityKeyRegistry.ts"
    timestamp: "2026-01-06T14:00:00Z"
    status: "complete"
    phase: "phase-2-task22"

  - agent: "frontend-developer"
    artifact: "src/hooks/useDrawerUrlState.ts"
    timestamp: "2026-01-06T14:05:00Z"
    status: "complete"
    phase: "phase-2-task23"

  - agent: "frontend-developer"
    artifact: "src/components/LegacyUrlWarning.tsx"
    timestamp: "2026-01-06T14:05:00Z"
    status: "complete"
    phase: "phase-2-task24"

  - agent: "frontend-developer"
    artifact: "src/components/UnresolvedLinkDialog.tsx"
    timestamp: "2026-01-06T14:05:00Z"
    status: "complete"
    phase: "phase-2-task25"

  - agent: "frontend-developer"
    artifact: "src/hooks/useOpenEntityDrawer.ts"
    timestamp: "2026-01-06T14:15:00Z"
    status: "complete"
    phase: "phase-2-task26"

  - agent: "frontend-developer"
    artifact: "src/components/DrawerUrlHandler.tsx"
    timestamp: "2026-01-06T14:15:00Z"
    status: "complete"
    phase: "phase-2-task27"

  - agent: "frontend-developer"
    artifact: "src/utils/storageCleanup.ts"
    timestamp: "2026-01-06T14:15:00Z"
    status: "complete"
    phase: "phase-2-task28"

  - agent: "frontend-reviewer"
    artifact: "reviews/FRONTEND-REVIEWER-PHASE2-REVIEW.md"
    timestamp: "2026-01-06T12:00:00Z"
    status: "complete"
    phase: "phase-2-review"

  - agent: "frontend-security-reviewer"
    artifact: "FRONTEND-SECURITY-PHASE2-REVIEW.md"
    timestamp: "2026-01-06T23:15:00Z"
    status: "complete"
    phase: "phase-2-review"

  - agent: "test-lead"
    artifact: "TEST-LEAD-PHASE3-4-REVIEW.md"
    timestamp: "2026-01-07T20:00:00Z"
    status: "complete"
    phase: "phase-3-4-batches-1-3-review"

artifacts:
  - path: "reviews/FRONTEND-REVIEWER-PHASE0-REVIEW.md"
    type: "code-review"
    agent: "frontend-reviewer"
    phase: "phase-0"
    status: "approved"
    description: "Phase 0 code quality review covering performance baseline script, search param serialization, and forwardRef audit"

  - path: "PLAN.md"
    type: "project-plan"
    agent: "frontend-lead"
    phase: "planning"
    status: "approved"
    description: "Master plan for TanStack migration across 5 phases"

  - path: "phase-0-preparatory-work.md"
    type: "phase-spec"
    agent: "frontend-lead"
    phase: "phase-0"
    status: "approved"
    description: "Phase 0 specification with 4 PRs for test infrastructure and blocking items"

  - path: "frontend-tester-pr-0.1-implementation.md"
    type: "test-implementation"
    agent: "frontend-tester"
    phase: "phase-0-pr01"
    status: "complete"
    description: "PR 0.1 implementation - E2E URL helpers with 40 comprehensive tests (35 target exceeded)"

  - path: "frontend-tester-pr02-implementation.md"
    type: "test-implementation"
    agent: "frontend-tester"
    phase: "phase-0-pr02"
    status: "complete"
    description: "PR 0.2 implementation - Feature flag infrastructure tests with 13 tests passing"

  - path: "frontend-tester-phase1-task16-integration-tests.md"
    type: "test-implementation"
    agent: "frontend-tester"
    phase: "phase-1-task16"
    status: "complete"
    description: "Phase 1 Task 1.6 - Cache isolation integration tests with 8 tests verifying impersonation behavior"

  - path: "reviews/FRONTEND-LEAD-PHASE1-REVIEW.md"
    type: "architecture-review"
    agent: "frontend-lead"
    phase: "phase-1"
    status: "approved"
    grade: "A"
    description: "Phase 1 architecture review - all criteria passed, security fixes verified"

  - path: "reviews/FRONTEND-REVIEWER-PHASE1-REVIEW.md"
    type: "code-review"
    agent: "frontend-reviewer"
    phase: "phase-1"
    status: "approved"
    grade: "A-"
    description: "Phase 1 code quality review - production-ready, minor documentation suggestions"

  - path: "reviews/TEST-LEAD-PHASE1-REVIEW.md"
    type: "test-review"
    agent: "test-lead"
    phase: "phase-1"
    status: "approved-with-conditions"
    grade: "B+"
    description: "Phase 1 test coverage review - E2E OAuth test required before production"

  - path: "reviews/FRONTEND-REVIEWER-PHASE2-REVIEW.md"
    type: "code-review"
    agent: "frontend-reviewer"
    phase: "phase-2"
    status: "approved-with-recommendations"
    grade: "A-"
    description: "Phase 2 code quality review - production-ready with all security fixes, one minor file size issue"

  - path: "FRONTEND-SECURITY-PHASE2-REVIEW.md"
    type: "security-review"
    agent: "frontend-security-reviewer"
    phase: "phase-2"
    status: "approved"
    grade: "A-"
    description: "Phase 2 security review - all mandated security fixes verified passing, 4 new findings (1 MEDIUM, 3 LOW)"

  - path: "TEST-LEAD-PHASE3-4-REVIEW.md"
    type: "test-validation"
    agent: "test-lead"
    phase: "phase-3-4-batches-1-3"
    status: "approved-with-recommendations"
    grade: "A-"
    description: "Phase 3-4 Batches 1-3 test coverage review - 69 tests verified, all security fixes tested, router E2E tests required"
